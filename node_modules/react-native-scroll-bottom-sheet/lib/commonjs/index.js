"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.ScrollBottomSheet=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeReanimated=_interopRequireWildcard(require("react-native-reanimated"));var _reactNativeGestureHandler=require("react-native-gesture-handler");var _imperativeScrollOpti,_jsxFileName="/Users/raulgomezacuna/Development/react-native/react-native-scroll-bottom-sheet/src/index.tsx";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}var interpolateDeprecated=_reactNativeReanimated.default.interpolate,interpolateNode=_reactNativeReanimated.default.interpolateNode;var interpolate=interpolateNode!==null&&interpolateNode!==void 0?interpolateNode:interpolateDeprecated;var Easing=_reactNativeReanimated.EasingNode!==null&&_reactNativeReanimated.EasingNode!==void 0?_reactNativeReanimated.EasingNode:_reactNativeReanimated.Easing;var FlatListComponentType='FlatList';var ScrollViewComponentType='ScrollView';var SectionListComponentType='SectionList';var TimingAnimationType='timing';var SpringAnimationType='spring';var DEFAULT_SPRING_PARAMS={damping:50,mass:0.3,stiffness:121.6,overshootClamping:true,restSpeedThreshold:0.3,restDisplacementThreshold:0.3};var _Dimensions$get=_reactNative.Dimensions.get('window'),windowHeight=_Dimensions$get.height;var IOS_NORMAL_DECELERATION_RATE=0.998;var ANDROID_NORMAL_DECELERATION_RATE=0.985;var DEFAULT_ANIMATION_DURATION=250;var DEFAULT_EASING=Easing.inOut(Easing.linear);var imperativeScrollOptions=(_imperativeScrollOpti={},(0,_defineProperty2.default)(_imperativeScrollOpti,FlatListComponentType,{method:'scrollToIndex',args:{index:0,viewPosition:0,viewOffset:1000,animated:true}}),(0,_defineProperty2.default)(_imperativeScrollOpti,ScrollViewComponentType,{method:'scrollTo',args:{x:0,y:0,animated:true}}),(0,_defineProperty2.default)(_imperativeScrollOpti,SectionListComponentType,{method:'scrollToLocation',args:{itemIndex:0,sectionIndex:0,viewPosition:0,viewOffset:1000,animated:true}}),_imperativeScrollOpti);var ScrollBottomSheet=function(_Component){(0,_inherits2.default)(ScrollBottomSheet,_Component);var _super=_createSuper(ScrollBottomSheet);function ScrollBottomSheet(props){var _props$animationConfi;var _this;(0,_classCallCheck2.default)(this,ScrollBottomSheet);_this=_super.call(this,props);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"masterDrawer",_react.default.createRef());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"drawerHandleRef",_react.default.createRef());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"drawerContentRef",_react.default.createRef());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"scrollComponentRef",_react.default.createRef());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onScrollBeginDrag",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onHandleGestureEvent",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"onDrawerGestureEvent",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"translateY",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"position",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"isManuallySetValue",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"manualYOffset",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"nextSnapIndex",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"decelerationRate",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"prevSnapIndex",-1);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"dragY",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"prevDragY",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"tempDestSnapPoint",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"isAndroid",new _reactNativeReanimated.Value(Number(_reactNative.Platform.OS==='android')));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"animationClock",new _reactNativeReanimated.Clock());(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"animationPosition",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"animationFinished",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"animationFrameTime",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"velocityY",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"lastStartScrollY",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"prevTranslateYOffset",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"translationY",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"destSnapPoint",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"lastSnap",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"dragWithHandle",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"scrollUpAndPullDown",new _reactNativeReanimated.Value(0));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"didGestureFinish",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"didScrollUpAndPullDown",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"setTranslationY",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"extraOffset",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"calculateNextSnapPoint",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"scrollComponent",void 0);(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"convertPercentageToDp",function(str){return Number(str.split('%')[0])*(windowHeight-_this.props.topInset)/100;});(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"getNormalisedSnapPoints",function(){return _this.props.snapPoints.map(function(p){if(typeof p==='string'){return _this.convertPercentageToDp(p);}else if(typeof p==='number'){return p;}throw new Error("Invalid type for value ".concat(p,": ").concat(typeof p,". It should be either a percentage string or a number"));});});(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"getScrollComponent",function(){switch(_this.props.componentType){case'FlatList':return _reactNative.FlatList;case'ScrollView':return _reactNative.ScrollView;case'SectionList':return _reactNative.SectionList;default:throw new Error('Component type not supported: it should be one of `FlatList`, `ScrollView` or `SectionList`');}});(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"snapTo",function(index){var snapPoints=_this.getNormalisedSnapPoints();_this.isManuallySetValue.setValue(1);_this.manualYOffset.setValue(snapPoints[index]);_this.nextSnapIndex.setValue(index);});var initialSnapIndex=props.initialSnapIndex,animationType=props.animationType;var animationDriver=animationType==='timing'?0:1;var animationDuration=props.animationType==='timing'&&((_props$animationConfi=props.animationConfig)===null||_props$animationConfi===void 0?void 0:_props$animationConfi.duration)||DEFAULT_ANIMATION_DURATION;var ScrollComponent=_this.getScrollComponent();_this.scrollComponent=_reactNativeReanimated.default.createAnimatedComponent(ScrollComponent);var _snapPoints=_this.getNormalisedSnapPoints();var openPosition=_snapPoints[0];var closedPosition=_this.props.enableOverScroll?windowHeight:_snapPoints[_snapPoints.length-1];var initialSnap=_snapPoints[initialSnapIndex];_this.nextSnapIndex=new _reactNativeReanimated.Value(initialSnapIndex);var initialDecelerationRate=_reactNative.Platform.select({android:props.initialSnapIndex===0?ANDROID_NORMAL_DECELERATION_RATE:0,ios:IOS_NORMAL_DECELERATION_RATE});_this.decelerationRate=new _reactNativeReanimated.Value(initialDecelerationRate);var handleGestureState=new _reactNativeReanimated.Value(-1);var handleOldGestureState=new _reactNativeReanimated.Value(-1);var drawerGestureState=new _reactNativeReanimated.Value(-1);var drawerOldGestureState=new _reactNativeReanimated.Value(-1);var lastSnapInRange=new _reactNativeReanimated.Value(1);_this.prevTranslateYOffset=new _reactNativeReanimated.Value(initialSnap);_this.translationY=new _reactNativeReanimated.Value(initialSnap);_this.lastSnap=new _reactNativeReanimated.Value(initialSnap);_this.onHandleGestureEvent=(0,_reactNativeReanimated.event)([{nativeEvent:{translationY:_this.dragY,oldState:handleOldGestureState,state:handleGestureState,velocityY:_this.velocityY}}]);_this.onDrawerGestureEvent=(0,_reactNativeReanimated.event)([{nativeEvent:{translationY:_this.dragY,oldState:drawerOldGestureState,state:drawerGestureState,velocityY:_this.velocityY}}]);_this.onScrollBeginDrag=(0,_reactNativeReanimated.event)([{nativeEvent:{contentOffset:{y:_this.lastStartScrollY}}}]);var didHandleGestureBegin=(0,_reactNativeReanimated.eq)(handleGestureState,_reactNativeGestureHandler.State.ACTIVE);var isAnimationInterrupted=(0,_reactNativeReanimated.and)((0,_reactNativeReanimated.or)((0,_reactNativeReanimated.eq)(handleGestureState,_reactNativeGestureHandler.State.BEGAN),(0,_reactNativeReanimated.eq)(drawerGestureState,_reactNativeGestureHandler.State.BEGAN),(0,_reactNativeReanimated.and)((0,_reactNativeReanimated.eq)(_this.isAndroid,0),(0,_reactNativeReanimated.eq)(animationDriver,1),(0,_reactNativeReanimated.or)((0,_reactNativeReanimated.eq)(drawerGestureState,_reactNativeGestureHandler.State.ACTIVE),(0,_reactNativeReanimated.eq)(handleGestureState,_reactNativeGestureHandler.State.ACTIVE)))),(0,_reactNativeReanimated.clockRunning)(_this.animationClock));_this.didGestureFinish=(0,_reactNativeReanimated.or)((0,_reactNativeReanimated.and)((0,_reactNativeReanimated.eq)(handleOldGestureState,_reactNativeGestureHandler.State.ACTIVE),(0,_reactNativeReanimated.eq)(handleGestureState,_reactNativeGestureHandler.State.END)),(0,_reactNativeReanimated.and)((0,_reactNativeReanimated.eq)(drawerOldGestureState,_reactNativeGestureHandler.State.ACTIVE),(0,_reactNativeReanimated.eq)(drawerGestureState,_reactNativeGestureHandler.State.END)));var isLastSnapPointInRange=function isLastSnapPointInRange(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return i===_snapPoints.length?lastSnapInRange:(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(_this.lastSnap,_snapPoints[i]),[(0,_reactNativeReanimated.set)(lastSnapInRange,1)],isLastSnapPointInRange(i+1));};var scrollY=[(0,_reactNativeReanimated.set)(lastSnapInRange,0),isLastSnapPointInRange(),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.or)(didHandleGestureBegin,(0,_reactNativeReanimated.and)(_this.isManuallySetValue,(0,_reactNativeReanimated.not)((0,_reactNativeReanimated.eq)(_this.manualYOffset,_snapPoints[0])))),[(0,_reactNativeReanimated.set)(_this.dragWithHandle,1),0]),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.and)((0,_reactNativeReanimated.eq)(_this.dragWithHandle,1),(0,_reactNativeReanimated.greaterThan)(_snapPoints[0],(0,_reactNativeReanimated.add)(_this.lastSnap,_this.dragY)),(0,_reactNativeReanimated.and)((0,_reactNativeReanimated.not)((0,_reactNativeReanimated.eq)(_this.lastSnap,_snapPoints[0])),lastSnapInRange)),[(0,_reactNativeReanimated.set)(_this.lastSnap,_snapPoints[0]),(0,_reactNativeReanimated.set)(_this.dragWithHandle,0),_this.lastStartScrollY],(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(_this.dragWithHandle,1),0,_this.lastStartScrollY))];_this.didScrollUpAndPullDown=(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.and)((0,_reactNativeReanimated.greaterOrEq)(_this.dragY,_this.lastStartScrollY),(0,_reactNativeReanimated.greaterThan)(_this.lastStartScrollY,0)),(0,_reactNativeReanimated.set)(_this.scrollUpAndPullDown,1));_this.setTranslationY=(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.and)((0,_reactNativeReanimated.not)(_this.dragWithHandle),(0,_reactNativeReanimated.not)((0,_reactNativeReanimated.greaterOrEq)(_this.dragY,_this.lastStartScrollY))),(0,_reactNativeReanimated.set)(_this.translationY,(0,_reactNativeReanimated.sub)(_this.dragY,_this.lastStartScrollY)),(0,_reactNativeReanimated.set)(_this.translationY,_this.dragY));_this.extraOffset=(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(_this.scrollUpAndPullDown,1),_this.lastStartScrollY,0);var endOffsetY=(0,_reactNativeReanimated.add)(_this.lastSnap,_this.translationY,(0,_reactNativeReanimated.multiply)(1-props.friction,_this.velocityY));_this.calculateNextSnapPoint=function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return i===_snapPoints.length?_this.tempDestSnapPoint:(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.greaterThan)((0,_reactNativeReanimated.abs)((0,_reactNativeReanimated.sub)(_this.tempDestSnapPoint,endOffsetY)),(0,_reactNativeReanimated.abs)((0,_reactNativeReanimated.sub)((0,_reactNativeReanimated.add)(_snapPoints[i],_this.extraOffset),endOffsetY))),[(0,_reactNativeReanimated.set)(_this.tempDestSnapPoint,(0,_reactNativeReanimated.add)(_snapPoints[i],_this.extraOffset)),(0,_reactNativeReanimated.set)(_this.nextSnapIndex,i),_this.calculateNextSnapPoint(i+1)],_this.calculateNextSnapPoint(i+1));};var runAnimation=function runAnimation(_ref){var _props$animationConfi2;var clock=_ref.clock,from=_ref.from,to=_ref.to,position=_ref.position,finished=_ref.finished,velocity=_ref.velocity,frameTime=_ref.frameTime;var state={finished:finished,velocity:new _reactNativeReanimated.Value(0),position:position,time:new _reactNativeReanimated.Value(0),frameTime:frameTime};var timingConfig={duration:animationDuration,easing:props.animationType==='timing'&&((_props$animationConfi2=props.animationConfig)===null||_props$animationConfi2===void 0?void 0:_props$animationConfi2.easing)||DEFAULT_EASING,toValue:new _reactNativeReanimated.Value(0)};var springConfig=_objectSpread(_objectSpread(_objectSpread({},DEFAULT_SPRING_PARAMS),props.animationType==='spring'&&props.animationConfig||{}),{},{toValue:new _reactNativeReanimated.Value(0)});return[(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.and)((0,_reactNativeReanimated.not)((0,_reactNativeReanimated.clockRunning)(clock)),(0,_reactNativeReanimated.not)((0,_reactNativeReanimated.eq)(finished,1))),[(0,_reactNativeReanimated.set)(state.finished,0),(0,_reactNativeReanimated.set)(state.velocity,velocity),(0,_reactNativeReanimated.set)(state.time,0),(0,_reactNativeReanimated.set)(state.position,from),(0,_reactNativeReanimated.set)(state.frameTime,0),(0,_reactNativeReanimated.set)(timingConfig.toValue,to),(0,_reactNativeReanimated.set)(springConfig.toValue,to),(0,_reactNativeReanimated.startClock)(clock)]),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(animationDriver,0),(0,_reactNativeReanimated.timing)(clock,state,timingConfig),(0,_reactNativeReanimated.spring)(clock,state,springConfig)),(0,_reactNativeReanimated.cond)(state.finished,[(0,_reactNativeReanimated.call)([_this.nextSnapIndex],function(_ref2){var _ref3=(0,_slicedToArray2.default)(_ref2,1),value=_ref3[0];if(value!==_this.prevSnapIndex){var _this$props$onSettle,_this$props;(_this$props$onSettle=(_this$props=_this.props).onSettle)===null||_this$props$onSettle===void 0?void 0:_this$props$onSettle.call(_this$props,value);}_this.prevSnapIndex=value;}),(0,_reactNativeReanimated.set)(drawerOldGestureState,_reactNativeGestureHandler.State.END),(0,_reactNativeReanimated.set)(handleOldGestureState,_reactNativeGestureHandler.State.END),(0,_reactNativeReanimated.set)(_this.prevTranslateYOffset,state.position),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(_this.scrollUpAndPullDown,1),[(0,_reactNativeReanimated.set)(_this.prevTranslateYOffset,(0,_reactNativeReanimated.sub)(_this.prevTranslateYOffset,_this.lastStartScrollY)),(0,_reactNativeReanimated.set)(_this.lastStartScrollY,0),(0,_reactNativeReanimated.set)(_this.scrollUpAndPullDown,0)]),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(_this.destSnapPoint,_snapPoints[0]),[(0,_reactNativeReanimated.set)(_this.dragWithHandle,0)]),(0,_reactNativeReanimated.set)(_this.isManuallySetValue,0),(0,_reactNativeReanimated.set)(_this.manualYOffset,0),(0,_reactNativeReanimated.stopClock)(clock),_this.prevTranslateYOffset],state.position)];};var translateYOffset=(0,_reactNativeReanimated.cond)(isAnimationInterrupted,[(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.or)(_this.dragWithHandle,(0,_reactNativeReanimated.greaterOrEq)((0,_reactNativeReanimated.abs)(_this.prevDragY),_this.lastStartScrollY)),(0,_reactNativeReanimated.set)(_this.prevTranslateYOffset,_this.animationPosition)),(0,_reactNativeReanimated.set)(_this.animationFinished,1),(0,_reactNativeReanimated.set)(_this.translationY,0),(0,_reactNativeReanimated.set)(drawerOldGestureState,_reactNativeGestureHandler.State.END),(0,_reactNativeReanimated.set)(handleOldGestureState,_reactNativeGestureHandler.State.END),(0,_reactNativeReanimated.set)(_this.animationFrameTime,(0,_reactNativeReanimated.add)(animationDuration,1000)),(0,_reactNativeReanimated.set)(_this.velocityY,0),(0,_reactNativeReanimated.stopClock)(_this.animationClock),_this.prevTranslateYOffset],(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.or)(_this.didGestureFinish,_this.isManuallySetValue,(0,_reactNativeReanimated.clockRunning)(_this.animationClock)),[runAnimation({clock:_this.animationClock,from:(0,_reactNativeReanimated.cond)(_this.isManuallySetValue,_this.prevTranslateYOffset,(0,_reactNativeReanimated.add)(_this.prevTranslateYOffset,_this.translationY)),to:_this.destSnapPoint,position:_this.animationPosition,finished:_this.animationFinished,frameTime:_this.animationFrameTime,velocity:_this.velocityY})],[(0,_reactNativeReanimated.set)(_this.animationFrameTime,0),(0,_reactNativeReanimated.set)(_this.animationFinished,0),_this.prevTranslateYOffset]));_this.translateY=interpolate((0,_reactNativeReanimated.add)(translateYOffset,_this.dragY,(0,_reactNativeReanimated.multiply)(scrollY,-1)),{inputRange:[openPosition,closedPosition],outputRange:[openPosition,closedPosition],extrapolate:_reactNativeReanimated.Extrapolate.CLAMP});_this.position=interpolate(_this.translateY,{inputRange:[openPosition,_snapPoints[_snapPoints.length-1]],outputRange:[1,0],extrapolate:_reactNativeReanimated.Extrapolate.CLAMP});return _this;}(0,_createClass2.default)(ScrollBottomSheet,[{key:"render",value:function render(){var _this2=this;var _this$props2=this.props,renderHandle=_this$props2.renderHandle,snapPoints=_this$props2.snapPoints,initialSnapIndex=_this$props2.initialSnapIndex,componentType=_this$props2.componentType,onSettle=_this$props2.onSettle,animatedPosition=_this$props2.animatedPosition,containerStyle=_this$props2.containerStyle,rest=(0,_objectWithoutProperties2.default)(_this$props2,["renderHandle","snapPoints","initialSnapIndex","componentType","onSettle","animatedPosition","containerStyle"]);var AnimatedScrollableComponent=this.scrollComponent;var normalisedSnapPoints=this.getNormalisedSnapPoints();var initialSnap=normalisedSnapPoints[initialSnapIndex];var Content=_react.default.createElement(_reactNativeReanimated.default.View,{style:[_reactNative.StyleSheet.absoluteFillObject,containerStyle,{transform:[{translateY:this.translateY}]}],__source:{fileName:_jsxFileName,lineNumber:693,columnNumber:7}},_react.default.createElement(_reactNativeGestureHandler.PanGestureHandler,{ref:this.drawerHandleRef,shouldCancelWhenOutside:false,simultaneousHandlers:this.masterDrawer,onGestureEvent:this.onHandleGestureEvent,onHandlerStateChange:this.onHandleGestureEvent,__source:{fileName:_jsxFileName,lineNumber:703,columnNumber:9}},_react.default.createElement(_reactNativeReanimated.default.View,{__source:{fileName:_jsxFileName,lineNumber:710,columnNumber:11}},renderHandle())),_react.default.createElement(_reactNativeGestureHandler.PanGestureHandler,{ref:this.drawerContentRef,simultaneousHandlers:[this.scrollComponentRef,this.masterDrawer],shouldCancelWhenOutside:false,onGestureEvent:this.onDrawerGestureEvent,onHandlerStateChange:this.onDrawerGestureEvent,__source:{fileName:_jsxFileName,lineNumber:712,columnNumber:9}},_react.default.createElement(_reactNativeReanimated.default.View,{style:styles.container,__source:{fileName:_jsxFileName,lineNumber:719,columnNumber:11}},_react.default.createElement(_reactNativeGestureHandler.NativeViewGestureHandler,{ref:this.scrollComponentRef,waitFor:this.masterDrawer,simultaneousHandlers:this.drawerContentRef,__source:{fileName:_jsxFileName,lineNumber:720,columnNumber:13}},_react.default.createElement(AnimatedScrollableComponent,(0,_extends2.default)({overScrollMode:"never",bounces:false},rest,{ref:this.props.innerRef,decelerationRate:this.decelerationRate,onScrollBeginDrag:this.onScrollBeginDrag,scrollEventThrottle:1,contentContainerStyle:[rest.contentContainerStyle,{paddingBottom:this.getNormalisedSnapPoints()[0]}],__source:{fileName:_jsxFileName,lineNumber:725,columnNumber:15}}))))),this.props.animatedPosition&&_react.default.createElement(_reactNativeReanimated.default.Code,{exec:(0,_reactNativeReanimated.onChange)(this.position,(0,_reactNativeReanimated.set)(this.props.animatedPosition,this.position)),__source:{fileName:_jsxFileName,lineNumber:743,columnNumber:11}}),_react.default.createElement(_reactNativeReanimated.default.Code,{exec:(0,_reactNativeReanimated.onChange)(this.dragY,(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.not)((0,_reactNativeReanimated.eq)(this.dragY,0)),(0,_reactNativeReanimated.set)(this.prevDragY,this.dragY))),__source:{fileName:_jsxFileName,lineNumber:750,columnNumber:9}}),_react.default.createElement(_reactNativeReanimated.default.Code,{exec:(0,_reactNativeReanimated.onChange)(this.didGestureFinish,(0,_reactNativeReanimated.cond)(this.didGestureFinish,[this.didScrollUpAndPullDown,this.setTranslationY,(0,_reactNativeReanimated.set)(this.tempDestSnapPoint,(0,_reactNativeReanimated.add)(normalisedSnapPoints[0],this.extraOffset)),(0,_reactNativeReanimated.set)(this.nextSnapIndex,0),(0,_reactNativeReanimated.set)(this.destSnapPoint,this.calculateNextSnapPoint()),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.and)((0,_reactNativeReanimated.greaterThan)(this.dragY,this.lastStartScrollY),this.isAndroid,(0,_reactNativeReanimated.not)(this.dragWithHandle)),(0,_reactNativeReanimated.call)([],function(){var _this2$props$innerRef,_this2$props,_this2$props$data;var _imperativeScrollOpti2=imperativeScrollOptions[_this2.props.componentType],method=_imperativeScrollOpti2.method,args=_imperativeScrollOpti2.args;var node=(_this2$props$innerRef=_this2.props.innerRef.current)===null||_this2$props$innerRef===void 0?void 0:_this2$props$innerRef.getNode();if(node&&node[method]&&(_this2.props.componentType==='FlatList'&&(((_this2$props=_this2.props)===null||_this2$props===void 0?void 0:(_this2$props$data=_this2$props.data)===null||_this2$props$data===void 0?void 0:_this2$props$data.length)||0)>0||_this2.props.componentType==='SectionList'&&_this2.props.sections.length>0||_this2.props.componentType==='ScrollView')){node[method](args);}})),(0,_reactNativeReanimated.set)(this.dragY,0),(0,_reactNativeReanimated.set)(this.velocityY,0),(0,_reactNativeReanimated.set)(this.lastSnap,(0,_reactNativeReanimated.sub)(this.destSnapPoint,(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(this.scrollUpAndPullDown,1),this.lastStartScrollY,0))),(0,_reactNativeReanimated.call)([this.lastSnap],function(_ref4){var _this2$masterDrawer,_this2$masterDrawer$c;var _ref5=(0,_slicedToArray2.default)(_ref4,1),value=_ref5[0];(_this2$masterDrawer=_this2.masterDrawer)===null||_this2$masterDrawer===void 0?void 0:(_this2$masterDrawer$c=_this2$masterDrawer.current)===null||_this2$masterDrawer$c===void 0?void 0:_this2$masterDrawer$c.setNativeProps({maxDeltaY:value-_this2.getNormalisedSnapPoints()[0]});}),(0,_reactNativeReanimated.set)(this.decelerationRate,(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(this.isAndroid,1),(0,_reactNativeReanimated.cond)((0,_reactNativeReanimated.eq)(this.lastSnap,normalisedSnapPoints[0]),ANDROID_NORMAL_DECELERATION_RATE,0),IOS_NORMAL_DECELERATION_RATE))])),__source:{fileName:_jsxFileName,lineNumber:756,columnNumber:9}}),_react.default.createElement(_reactNativeReanimated.default.Code,{exec:(0,_reactNativeReanimated.onChange)(this.isManuallySetValue,[(0,_reactNativeReanimated.cond)(this.isManuallySetValue,[(0,_reactNativeReanimated.set)(this.destSnapPoint,this.manualYOffset),(0,_reactNativeReanimated.set)(this.animationFinished,0),(0,_reactNativeReanimated.set)(this.lastSnap,this.manualYOffset),(0,_reactNativeReanimated.call)([this.lastSnap],function(_ref6){var _this2$masterDrawer2,_this2$masterDrawer2$;var _ref7=(0,_slicedToArray2.default)(_ref6,1),value=_ref7[0];(_this2$masterDrawer2=_this2.masterDrawer)===null||_this2$masterDrawer2===void 0?void 0:(_this2$masterDrawer2$=_this2$masterDrawer2.current)===null||_this2$masterDrawer2$===void 0?void 0:_this2$masterDrawer2$.setNativeProps({maxDeltaY:value-_this2.getNormalisedSnapPoints()[0]});})],[(0,_reactNativeReanimated.set)(this.nextSnapIndex,0)])]),__source:{fileName:_jsxFileName,lineNumber:831,columnNumber:9}}));if(_reactNative.Platform.OS==='android'){return _react.default.createElement(_reactNativeGestureHandler.TapGestureHandler,{maxDurationMs:100000,ref:this.masterDrawer,maxDeltaY:initialSnap-this.getNormalisedSnapPoints()[0],shouldCancelWhenOutside:false,__source:{fileName:_jsxFileName,lineNumber:858,columnNumber:9}},Content);}return _react.default.createElement(_reactNativeGestureHandler.TapGestureHandler,{maxDurationMs:100000,ref:this.masterDrawer,maxDeltaY:initialSnap-this.getNormalisedSnapPoints()[0],__source:{fileName:_jsxFileName,lineNumber:873,columnNumber:7}},_react.default.createElement(_reactNative.View,{style:_reactNative.StyleSheet.absoluteFillObject,pointerEvents:"box-none",__source:{fileName:_jsxFileName,lineNumber:878,columnNumber:9}},Content));}}]);return ScrollBottomSheet;}(_react.Component);exports.ScrollBottomSheet=ScrollBottomSheet;(0,_defineProperty2.default)(ScrollBottomSheet,"defaultProps",{topInset:0,friction:0.95,animationType:'timing',innerRef:_react.default.createRef(),enableOverScroll:false});var _default=ScrollBottomSheet;exports.default=_default;var styles=_reactNative.StyleSheet.create({container:{flex:1}});
//# sourceMappingURL=index.js.map